<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Regression with Feature Extractor · ml5js</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="This example uses the feature extraction method over the MobileNet model to create a regression and output continuos values. This will allow you to control a slider after training the model between just three categories of images."/><meta property="og:title" content="Regression with Feature Extractor · ml5js"/><meta property="og:type" content="website"/><meta property="og:url" content="ml5js.org/index.html"/><meta property="og:description" content="This example uses the feature extraction method over the MobileNet model to create a regression and output continuos values. This will allow you to control a slider after training the model between just three categories of images."/><meta property="og:image" content="ml5js.org/img/og.jpg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="ml5js.org/img/og.jpg"/><link rel="shortcut icon" href="/img/favicon.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css"/><script type="text/javascript" src="/scripts/ml5.min.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.5.16/p5.min.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.5.16/addons/p5.dom.min.js"></script><link rel="stylesheet" href="/css/main.css"/></head><body class="sideNavVisible doc separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/ml5.png" alt="ml5js"/></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/getting-started.html" target="_self">Reference</a></li><li class="siteNavGroupActive"><a href="/docs/quick-start.html" target="_self">Examples</a></li><li class="siteNavGroupActive"><a href="/docs/datasets.html" target="_self">Datasets</a></li><li class=""><a href="/en/experiments.html" target="_self">Experiments</a></li><li class=""><a href="/docs/glossary-statistics.html" target="_self">Learn</a></li><li class=""><a href="https://github.com/ml5js" target="_self">Code</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>Examples</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup navGroupActive"><h3>Documentation</h3><ul><li class="navListItem"><a class="navItem" href="/docs/getting-started.html">Getting Started</a></li><li class="navListItem"><a class="navItem" href="/docs/ImageClassifier.html">imageClassifier()</a></li><li class="navListItem"><a class="navItem" href="/docs/FeatureExtractor.html">featureExtractor()</a></li><li class="navListItem"><a class="navItem" href="/docs/LSTMGenerator.html">LSTMGenerator()</a></li><li class="navListItem"><a class="navItem" href="/docs/PitchDetection.html">pitchDetection()</a></li><li class="navListItem"><a class="navItem" href="/docs/PoseNet.html">poseNet()</a></li><li class="navListItem"><a class="navItem" href="/docs/StyleTransfer.html">styleTransfer()</a></li><li class="navListItem"><a class="navItem" href="/docs/Word2vec.html">word2vec()</a></li><li class="navListItem"><a class="navItem" href="/docs/YOLO.html">YOLO()</a></li></ul></div><div class="navGroup navGroupActive"><h3>Examples</h3><ul><li class="navListItem"><a class="navItem" href="/docs/quick-start.html">Quick Start</a></li><li class="navListItem"><a class="navItem" href="/docs/image-classification-example.html">Image Classification</a></li><li class="navListItem"><a class="navItem" href="/docs/video-classification-example.html">Video Classification</a></li><li class="navListItem"><a class="navItem" href="/docs/custom-classifier.html">Classifier with Feature Extractor</a></li><li class="navListItem navListItemActive"><a class="navItem navItemActive" href="/docs/custom-regression.html">Regression with Feature Extractor</a></li><li class="navListItem"><a class="navItem" href="/docs/lstm-example.html">Text Generation with LSTM</a></li><li class="navListItem"><a class="navItem" href="/docs/lstm-interactive-example.html">Interactive Text Generation LSTM</a></li><li class="navListItem"><a class="navItem" href="/docs/style-transfer-image-example.html">Style Transfer</a></li><li class="navListItem"><a class="navItem" href="/docs/style-transfer-webcam-example.html">Style Transfer with Webcam</a></li><li class="navListItem"><a class="navItem" href="/docs/posenet-webcam.html">PoseNet with Webcam</a></li><li class="navListItem"><a class="navItem" href="/docs/yolo-webcam.html">YOLO with Webcam</a></li><li class="navListItem"><a class="navItem" href="/docs/word2vec-example.html">Word2Vec</a></li></ul></div><div class="navGroup navGroupActive"><h3>Datasets</h3><ul><li class="navListItem"><a class="navItem" href="/docs/datasets.html">Datasets</a></li><li class="navListItem"><a class="navItem" href="/docs/making-datasets.html">Making Your Own Datasets</a></li></ul></div><div class="navGroup navGroupActive"><h3>Training Models</h3><ul><li class="navListItem"><a class="navItem" href="/docs/training-setup.html">Python Setup</a></li><li class="navListItem"><a class="navItem" href="/docs/training-lstm.html">Training a LSTM</a></li></ul></div></div></section></div><script>
            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              const headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                if (event.target.tagName === 'A') {
                  document.body.classList.remove('tocActive');
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1>Regression with Feature Extractor</h1></header><article><div><span><p>This example uses the feature extraction method over the MobileNet model to create a regression and output continuos values. This will allow you to control a slider after training the model between just three categories of images.</p>
<p><em>Please enable your webcam</em></p>
<h2><a class="anchor" aria-hidden="true" id="demo"></a><a href="#demo" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Demo</h2>
<style>
  .example button {
    margin: 4px;
    padding: 8px;
  }
  .example video{
    width: 300;
    height: 300;
  }
  .example p{
    display: inline;
    font-size: 14px;
  }
  .example h6{
    font-size: 14px;
    margin-bottom: 10px;
  }
</style>
<div class="example">
  <div id="videoContainer"></div>
  <h6 id="loading">Loading base model...</h6>
  <h5>Instructions</h5>
  <p>1. With the slider on the middle and your face over the red square, click the 'Add Sample' button. Try adding around 15 images.</p>
  <br>
  <p>2. Move the slider all the way to the left and your head all the way to the left of your camera, click the 'Add Sample' button. Try adding around 15 images.</p>
  <br>
  <p>3. Move the slider all the way to the right and your head all the way to the right of your camera, click the 'Add Sample' button. Try adding around 15 images.</p>
  <br>
  <p>4. Click 'Train' and wait for the model to be trained</p>
  <br>
  <p>4. Click 'Start predicting!' and move your face left and right!</p>
  <br>
  <br>
<p><input type="range" name="slider" id="slider" min="0.01" max="1.0" step="0.01" value="0.5">
<br></p>
  <p>
    <button id="addSample">Add Sample</button>
    <p><span id="amountOfSamples">0</span> Sample Images</p>
  </p>
<p><br/></p>
  <p><button id="train">Train</button><span id="loss"></span></p>
  <br/>
  <p>
    <button id="buttonPredict">Start predicting!</button><br>
  </p>
</div>
<script src="assets/scripts/example-custom-regression.js"></script>
<h2><a class="anchor" aria-hidden="true" id="code"></a><a href="#code" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Code</h2>
<pre><code class="hljs css languages- javascript"><span class="hljs-keyword">let</span> featureExtractor;
<span class="hljs-keyword">let</span> regressor;
<span class="hljs-keyword">let</span> video;
<span class="hljs-keyword">let</span> loss;
<span class="hljs-keyword">let</span> slider;
<span class="hljs-keyword">let</span> addSample;
<span class="hljs-keyword">let</span> samples = <span class="hljs-number">0</span>;
<span class="hljs-keyword">let</span> positionX = <span class="hljs-number">140</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setup</span>(<span class="hljs-params"></span>) </span>{
  createCanvas(<span class="hljs-number">340</span>, <span class="hljs-number">280</span>);
  <span class="hljs-comment">// Create a video element</span>
  video = createCapture(VIDEO);
  <span class="hljs-comment">// Append it to the videoContainer DOM element</span>
  video.hide();
  <span class="hljs-comment">// Extract the features from Mobilenet</span>
  featureExtractor = ml5.featureExtractor(<span class="hljs-string">'Mobilenet'</span>, modelReady);
  <span class="hljs-comment">// Create a new regressor using those features and give the video we want to use</span>
  regressor = featureExtractor.regression(video);
  <span class="hljs-comment">// Create the UI buttons</span>
  createButtons();
  noStroke();
  fill(<span class="hljs-number">255</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">draw</span>(<span class="hljs-params"></span>) </span>{
  image(video, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">340</span>, <span class="hljs-number">280</span>);
  rect(positionX, <span class="hljs-number">120</span>, <span class="hljs-number">50</span>, <span class="hljs-number">50</span>);
}

<span class="hljs-comment">// A function to be called when the model has been loaded</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">modelReady</span>(<span class="hljs-params"></span>) </span>{
  select(<span class="hljs-string">'#loading'</span>).html(<span class="hljs-string">'Model loaded!'</span>);
}

<span class="hljs-comment">// Classify the current frame.</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">predict</span>(<span class="hljs-params"></span>) </span>{
  regressor.predict(gotResults);
}

<span class="hljs-comment">// A util function to create UI buttons</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createButtons</span>(<span class="hljs-params"></span>) </span>{
  slider = select(<span class="hljs-string">'#slider'</span>);
  <span class="hljs-comment">// When the Dog button is pressed, add the current frame</span>
  <span class="hljs-comment">// from the video with a label of "dog" to the classifier</span>
  addSample = select(<span class="hljs-string">'#addSample'</span>);
  addSample.mousePressed(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    regressor.addImage(slider.value());
    select(<span class="hljs-string">'#amountOfSamples'</span>).html(samples++);
  });

  <span class="hljs-comment">// Train Button</span>
  train = select(<span class="hljs-string">'#train'</span>);
  train.mousePressed(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    regressor.train(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">lossValue</span>) </span>{
      <span class="hljs-keyword">if</span> (lossValue) {
        loss = lossValue;
        select(<span class="hljs-string">'#loss'</span>).html(<span class="hljs-string">'Loss: '</span> + loss);
      } <span class="hljs-keyword">else</span> {
        select(<span class="hljs-string">'#loss'</span>).html(<span class="hljs-string">'Done Training! Final Loss: '</span> + loss);
      }
    });
  });

  <span class="hljs-comment">// Predict Button</span>
  buttonPredict = select(<span class="hljs-string">'#buttonPredict'</span>);
  buttonPredict.mousePressed(predict);
}

<span class="hljs-comment">// Show the results</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">gotResults</span>(<span class="hljs-params">result</span>) </span>{
  positionX = map(result, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, width);
  slider.value(result);
  predict();
}
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="source-https-githubcom-ml5js-ml5-examples-tree-master-p5js-featureextractor-image-classification"></a><a href="#source-https-githubcom-ml5js-ml5-examples-tree-master-p5js-featureextractor-image-classification" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><a href="https://github.com/ml5js/ml5-examples/tree/master/p5js/FeatureExtractor_Image_Classification">Source</a></h2>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="custom-classifier.html">← Classifier with Feature Extractor</a><a class="docs-next button" href="lstm-example.html">Text Generation with LSTM →</a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#demo">Demo</a></li><li><a href="#code">Code</a></li><li><a href="#source-https-githubcom-ml5js-ml5-examples-tree-master-p5js-featureextractor-image-classification">Source</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><div><h5>Docs</h5><a href="/docs/getting-started.html">Getting Started</a><a href="/docs/imagenet.html">API Reference</a><a href="/docs/training-models.html">Training Models</a></div><div><h5>Learning</h5><a href="/docs/tutorials.html">Tutorials</a><a href="/docs/glossary-statistics.html">Glossary</a><a href="/docs/resources.html">Resources</a></div><div><h5>Contribute</h5><a href="/experiments.html">Experiments</a><a href="https://github.com/ml5js/ml5-library">Contributing Guide</a><a class="github-button" href="https://github.com/ml5js/ml5-library" data-icon="octicon-star" data-count-href="https://github.com/ml5js/ml5-library" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><a href="https://itp.nyu.edu" target="_blank" class="fbOpenSource"><img src="/img/itp_logo.png" alt="Facebook Open Source" width="60" height="45"/></a><section class="copyright">This project is currently being maintained at NYU ITP by a community of teachers, residents and students.</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
              var search = docsearch({
                
                apiKey: '4e9582fa59998b865a9fd98ae8d8a9cc',
                indexName: 'ml5js',
                inputSelector: '#search_input_react'
              });
            </script></body></html>